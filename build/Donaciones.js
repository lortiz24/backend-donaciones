(()=>{"use strict";var e={783:function(e,t,o){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(o(142)),s=i(o(337));n.default.config(),(new s.default).listen()},597:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteContacto=t.updateContacto=t.createContacto=t.getContacto=t.getContactos=void 0;const s=n(o(195));t.getContactos=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield s.default.find({});t.status(200).send(e)}catch(e){t.json({error:e.message})}})),t.getContacto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findById(o);t.status(200).send(i)}catch(e){t.json({error:e.message})}})),t.createContacto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{email:o,message:i,name:n,asunto:a}=e.body,r=new s.default({email:o,message:i,name:n,asunto:a});yield r.save(),t.status(201).send(r)}catch(e){console.log(e),t.status(500).json({error:e.message})}})),t.updateContacto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,{email:i,message:n,name:a}=e.body;let r={};void 0!==i&&(r=Object.assign(Object.assign({},r),{email:i})),void 0!==n&&(r=Object.assign(Object.assign({},r),{message:n})),void 0!==a&&(r=Object.assign(Object.assign({},r),{name:a}));const d=yield s.default.findByIdAndUpdate(o,r);t.status(201).send(d)}catch(e){t.status(500).json(e.message)}})),t.deleteContacto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findByIdAndDelete(o);t.send(i)}catch(e){t.json({error:e.message})}}))},723:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteDonacion=t.updateDonacion=t.createDonacion=t.getDonacion=t.getDonaciones=void 0;const s=n(o(245)),a=n(o(155));t.getDonaciones=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield a.default.find({});t.status(200).send(e)}catch(e){t.json({error:e.message})}})),t.getDonacion=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield a.default.findById(o);t.status(200).send(i)}catch(e){t.json({error:e.message})}})),t.createDonacion=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const o=(0,s.default)().format("YYYY-MM-DD HH:mm:ss"),{donante:i,proyecto:n,medio_pago:r,monto_donacion:d,nombre:c,tipo:u}=e.body,l=new a.default({donante:i,proyecto:n,medio_pago:r,monto_donacion:d,tipo:u,fecha:o});0!==c.length&&(l.nombre=c),yield l.save(),t.status(201).send(l)}catch(e){console.log(e),t.status(500).json({error:e.message})}})),t.updateDonacion=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,{donante:i,proyecto:n,medio_pago:s,monto_donacion:r,nombre:d,tipo:c}=e.body;let u={};void 0!==c&&(u=Object.assign(Object.assign({},u),{tipo:c})),void 0!==d&&(u=Object.assign(Object.assign({},u),{nombre:d})),void 0!==s&&(u=Object.assign(Object.assign({},u),{medio_pago:s})),void 0!==r&&(u=Object.assign(Object.assign({},u),{monto_donacion:r})),void 0!==i&&(u=Object.assign(Object.assign({},u),{donante:i})),void 0!==n&&(u=Object.assign(Object.assign({},u),{proyecto:n}));const l=yield a.default.findByIdAndUpdate(o,u);t.status(201).send(l)}catch(e){t.status(500).json(e.message)}})),t.deleteDonacion=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield a.default.findByIdAndDelete(o);t.send(i)}catch(e){t.json({error:e.message})}}))},447:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteObjetosVario=t.updateObjetosVario=t.createObjetosVario=t.getObjetosVarioByTipo=t.getObjetosVario=t.getObjetosVarios=void 0;const s=n(o(454));t.getObjetosVarios=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield s.default.find({});t.status(200).send(e)}catch(e){t.json({error:e.message})}})),t.getObjetosVario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findById(o);t.status(200).send(i)}catch(e){t.json({error:e.message})}})),t.getObjetosVarioByTipo=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{tipo:o}=e.params,i=yield s.default.find({tipo:o.toUpperCase()});t.status(200).send(i)}catch(e){t.json({error:e.message})}})),t.createObjetosVario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{descripcion:o="",objeto:i={},tipo:n=""}=e.body,a=new s.default({tipo:n.toUpperCase(),objeto:i,descripcion:o});yield a.save(),t.status(201).send(a)}catch(e){console.log(e),t.status(500).json({error:e.message})}})),t.updateObjetosVario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,{descripcion:i,objeto:n,tipo:a}=e.body;let r={};void 0!==i&&(r=Object.assign(Object.assign({},r),{descripcion:i})),void 0!==n&&(r=Object.assign(Object.assign({},r),{objeto:n})),void 0!==a&&(r=Object.assign(Object.assign({},r),{tipo:a.toUpperCase()}));const d=yield s.default.findByIdAndUpdate(o,r);t.status(201).send(d)}catch(e){t.status(500).json(e.message)}})),t.deleteObjetosVario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findByIdAndDelete(o);t.send(i)}catch(e){t.json({error:e.message})}}))},660:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteProyecto=t.updateProyecto=t.createProyecto=t.getProyecto=t.getProyectos=void 0;const s=n(o(84));t.getProyectos=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield s.default.find({});t.status(200).send(e)}catch(e){t.json({error:e.message})}})),t.getProyecto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findById(o);t.status(200).send(i)}catch(e){t.json({error:e.message})}})),t.createProyecto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{descripcion:o,img:i,title:n,other:a,fecha_inicio:r,fecha_objetivo:d,monto_meta:c}=e.body,u=new s.default({descripcion:o,title:n,fecha_inicio:r});void 0!==d&&(u.fecha_objetivo=d),void 0!==c&&(u.monto_meta=c),void 0!==i&&(u.img=i),void 0!==a&&(u.img=a),yield u.save(),t.status(201).send(u)}catch(e){t.json({error:e.message})}})),t.updateProyecto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,{descripcion:i,img:n,title:a,other:r,fecha_inicio:d,fecha_objetivo:c,monto_meta:u,monto_recaudado:l}=e.body;let p={};void 0!==i&&(p=Object.assign(Object.assign({},p),{descripcion:i})),void 0!==n&&(p=Object.assign(Object.assign({},p),{img:n})),void 0!==a&&(p=Object.assign(Object.assign({},p),{title:a})),void 0!==r&&(p=Object.assign(Object.assign({},p),{other:r})),void 0!==d&&(p=Object.assign(Object.assign({},p),{fecha_inicio:d})),void 0!==c&&(p=Object.assign(Object.assign({},p),{fecha_objetivo:c})),void 0!==u&&(p=Object.assign(Object.assign({},p),{monto_meta:u})),void 0!==l&&(p=Object.assign(Object.assign({},p),{monto_recaudado:l})),console.log(p);const f=yield s.default.findByIdAndUpdate(o,p);t.status(201).send(f)}catch(e){t.json({error:e.message})}})),t.deleteProyecto=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findByIdAndDelete(o);t.send(i)}catch(e){t.json({error:e.message})}}))},610:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getMetricasProyectos=t.getCountPersonsDonacion=t.getEstadisticasVisitas=t.getCantidadProyectos=void 0;const s=n(o(245)),a=n(o(155)),r=n(o(84)),d=n(o(454)),c=n(o(721)),u=o(185);t.getCantidadProyectos=(e,t)=>i(void 0,void 0,void 0,(function*(){const{proyecto_id:o}=e.params;try{const e=yield a.default.find({proyecto:u.Types.ObjectId(o)});t.status(200).json({cantidad:e.length})}catch(e){t.json({error:e.message})}})),t.getEstadisticasVisitas=(e,t)=>i(void 0,void 0,void 0,(function*(){try{let e=["CARD_INICIO","LIST_PROYECTS","visita"],o={};for(const t of e){const e=yield c.default.find({"action.type":t});o=Object.assign(Object.assign({},o),{[t]:{cantidad:e.length,visitas:e.map((e=>({ip:e.ip.replace("::ffff:",""),fecha:e.fecha})))}})}t.status(200).json(o)}catch(e){t.json({error:e.message})}})),t.getCountPersonsDonacion=(e,t)=>i(void 0,void 0,void 0,(function*(){try{let e=[],o={};const i=yield r.default.find({}),n=yield d.default.find({tipo:"ROLES"});for(const t of i){const i=yield a.default.find({proyecto:t._id});for(const e of n){const i=yield a.default.find({proyecto:t._id,tipo:e.objeto.value});o=Object.assign(Object.assign({},o),{[e.objeto.value]:i.length})}const s=i.length,r=i.reduce(((e,t)=>e+t.monto_donacion),0)/i.length;e.push(Object.assign({proyecto:t.title,cantidadDonaciones:s,promedioDonacion:r.toFixed(3)},o))}t.status(200).json({cantidadByProyecto:e})}catch(e){t.json({error:e.message})}})),t.getMetricasProyectos=(e,t)=>i(void 0,void 0,void 0,(function*(){const{proyecto_id:o}=e.params;try{const e=yield a.default.find({proyecto:u.Types.ObjectId(o)}),i=yield r.default.findById(o);let n=0;e.forEach((e=>{n+=e.monto_donacion}));const d=(0,s.default)(),c=(0,s.default)(i.fecha_objetivo).diff(d,"days"),l=(n/i.monto_meta*100).toFixed();t.status(200).json({mongoAlcanzado:n,diasFaltantes:c,monto_meta:i.monto_meta,procentajeAlcanzado:l})}catch(e){t.json({error:e.message})}}))},12:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteUsuario=t.updateUsuario=t.createUsuario=t.getUsuario=t.getUsuariosAdmin=t.getUsuarios=void 0;const s=n(o(837));t.getUsuarios=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield s.default.find({});t.send(e)}catch(e){t.json({error:e.message})}})),t.getUsuariosAdmin=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield s.default.find({tipo:"ADMIN_ROLE"});t.send(e)}catch(e){t.json({error:e.message})}})),t.getUsuario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findById(o);t.send(i)}catch(e){t.json({error:e.message})}})),t.createUsuario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{email:o,nombre:i,tipo:n,descripcion:a,img:r,puesto:d,other:c}=e.body;let u={};u=Object.assign(Object.assign({},u),{email:o,nombre:i,tipo:n}),void 0!==a&&(u=Object.assign(Object.assign({},u),{descripcion:a})),void 0!==r&&(u=Object.assign(Object.assign({},u),{img:r})),void 0!==d&&(u=Object.assign(Object.assign({},u),{puesto:d})),void 0!==c&&(u=Object.assign(Object.assign({},u),{other:c}));const l=new s.default(u);yield l.save(),t.send(l)}catch(e){t.json({error:e.message})}})),t.updateUsuario=(e,t)=>i(void 0,void 0,void 0,(function*(){const{id:o}=e.params,{email:i,nombre:n,tipo:a,descripcion:r,img:d,puesto:c,other:u}=e.body;let l={};void 0!==i&&(l=Object.assign(Object.assign({},l),{email:i})),void 0!==n&&(l=Object.assign(Object.assign({},l),{nombre:n})),void 0!==a&&(l=Object.assign(Object.assign({},l),{tipo:a})),void 0!==r&&(l=Object.assign(Object.assign({},l),{descripcion:r})),void 0!==d&&(l=Object.assign(Object.assign({},l),{img:d})),void 0!==c&&(l=Object.assign(Object.assign({},l),{puesto:c})),void 0!==u&&(l=Object.assign(Object.assign({},l),{other:u}));const p=yield s.default.findByIdAndUpdate(o,l);t.send(p)})),t.deleteUsuario=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const{id:o}=e.params,i=yield s.default.findByIdAndDelete(o);t.json({usuario:i})}catch(e){t.json({error:e.message})}}))},912:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createVisita=t.getVisitas=void 0;const s=n(o(245)),a=n(o(721));t.getVisitas=(e,t)=>i(void 0,void 0,void 0,(function*(){try{const e=yield a.default.find({});t.status(200).send(e)}catch(e){t.json({error:e.message})}})),t.createVisita=(e,t)=>i(void 0,void 0,void 0,(function*(){const o=e.ip;try{const i=Date.now(),{fecha:n=(0,s.default)(i).format("YYYY-MM-DD HH:mm-ss"),action:r={type:"visita"}}=e.body,d=new a.default({fecha:n,ip:o,action:r});yield d.save(),t.status(201).send(d)}catch(e){console.log(e),t.status(500).json({error:e.message})}}))},243:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.dbConnection=void 0;const s=n(o(185));t.dbConnection=()=>i(void 0,void 0,void 0,(function*(){try{yield s.default.connect("mongodb+srv://donaciones:VrR4IJd7bPGGURhY@cluster0.pmj9moh.mongodb.net/?retryWrites=true&w=majority"),console.log("Database online")}catch(e){throw new Error(e.toString())}}))},20:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.existeProyectoById=t.existeContactoById=t.existUsuarioById=t.existeVisitaById=t.existeObjetoById=t.existeDonacionById=void 0;const s=n(o(155)),a=n(o(195)),r=n(o(84)),d=n(o(837)),c=n(o(721)),u=n(o(454));t.existeDonacionById=e=>i(void 0,void 0,void 0,(function*(){if(yield s.default.findById(e))return!0;throw new Error(`No existe una donacion con id: ${e} `)})),t.existeObjetoById=e=>i(void 0,void 0,void 0,(function*(){if(yield u.default.findById(e))return!0;throw new Error(`No existe un objeto con id: ${e} `)})),t.existeVisitaById=e=>i(void 0,void 0,void 0,(function*(){const t=yield c.default.find({ip:e});return console.log(t),0!==t.length})),t.existUsuarioById=e=>i(void 0,void 0,void 0,(function*(){if(yield d.default.findById(e))return!0;throw new Error(`No existe un usuario con id: ${e} `)})),t.existeContactoById=e=>i(void 0,void 0,void 0,(function*(){if(yield a.default.findById(e))return!0;throw new Error(`No existe un contacto con id: ${e} `)})),t.existeProyectoById=e=>i(void 0,void 0,void 0,(function*(){if(yield r.default.findById(e))return!0;throw new Error(`No existe un proyecto con id: ${e} `)}))},492:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validarCampos=void 0;const i=o(553);t.validarCampos=(e,t,o)=>{const n=(0,i.validationResult)(e);if(!n.isEmpty())return t.status(404).send(n);o()}},195:function(e,t,o){var i=this&&this.__rest||function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};Object.defineProperty(t,"__esModule",{value:!0});const{Schema:n,model:s}=o(185),a=n({name:{type:String,ref:"proyecto",required:[!0,"El nombre es requerido"]},email:{type:String,required:[!0,"El email es requerido"]},asunto:{type:String},message:{type:String,required:[!0,"El message es requerido"]}});a.methods.toJSON=function(){const e=this.toObject(),{__v:t,_id:o}=e,n=i(e,["__v","_id"]);return n.id=o,n},t.default=s("contacto",a)},155:function(e,t,o){var i=this&&this.__rest||function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};Object.defineProperty(t,"__esModule",{value:!0});const{Schema:n,model:s}=o(185),a=n({proyecto:{type:n.Types.ObjectId,ref:"proyecto",required:[!0,"El id del proyecto es requerido"]},medio_pago:{type:String,required:[!0,"El id de mediosPago  es requerido"]},monto_donacion:{type:Number,required:[!0,"monto_donacion es requerido"]},nombre:{type:String,default:"ANONIMO"},tipo:{type:String,required:[!0,"tipo  es requerido"]},fecha:{type:Date}});a.methods.toJSON=function(){const e=this.toObject(),{__v:t,_id:o}=e,n=i(e,["__v","_id"]);return n.id=o,n},t.default=s("donacion",a)},454:function(e,t,o){var i=this&&this.__rest||function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};Object.defineProperty(t,"__esModule",{value:!0});const{Schema:n,model:s}=o(185),a=n({tipo:{type:String,required:[!0,"El tipo es requerido"]},objeto:{type:JSON},descripcion:{type:String}});a.methods.toJSON=function(){const e=this.toObject(),{__v:t,_id:o}=e,n=i(e,["__v","_id"]);return n.id=o,n},t.default=s("objeto",a)},84:function(e,t,o){var i=this&&this.__rest||function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};Object.defineProperty(t,"__esModule",{value:!0});const{Schema:n,model:s}=o(185),a=n({img:{type:String,default:"none"},descripcion:{type:String,required:[!0,"La descripcion es requerida"]},title:{type:String,default:"none",required:[!0,"El tittle es requerido"]},monto_meta:{type:Number},fecha_inicio:{type:Date,required:[!0,"La fecha de inicio es requerida"]},fecha_objetivo:{type:Date},dias:{type:Number},other:{type:JSON}});a.methods.toJSON=function(){const e=this.toObject(),{__v:t,_id:o}=e,n=i(e,["__v","_id"]);return n.uid=o,n},t.default=s("proyecto",a)},837:function(e,t,o){var i=this&&this.__rest||function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};Object.defineProperty(t,"__esModule",{value:!0});const{Schema:n,model:s}=o(185),a=n({nombre:{type:String},email:{type:String,required:[!0,"email es requerido"]},tipo:{type:String,required:[!0,"tipo es requerido"],enum:["ADMIN_ROLE","USER_ROLE"]},img:{type:String},descripcion:{type:String},puesto:{type:String},other:{type:JSON}});a.methods.toJSON=function(){const e=this.toObject(),{__v:t,_id:o}=e,n=i(e,["__v","_id"]);return n.uid=o,n},t.default=s("usuario",a)},721:function(e,t,o){var i=this&&this.__rest||function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};Object.defineProperty(t,"__esModule",{value:!0});const{Schema:n,model:s}=o(185),a=n({ip:{type:String,unique:!1},fecha:{type:String},action:{type:JSON}});a.methods.toJSON=function(){const e=this.toObject(),{__v:t,_id:o}=e,n=i(e,["__v","_id"]);return n.uid=o,n},t.default=s("visita",a)},337:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function a(e){try{d(i.next(e))}catch(e){s(e)}}function r(e){try{d(i.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(o(860)),a=n(o(582)),r=o(243),d=n(o(993)),c=n(o(659)),u=n(o(502)),l=n(o(596)),p=n(o(330)),f=n(o(533)),y=n(o(103)),v=n(o(88));t.default=class{constructor(){this.app=(0,s.default)(),this.port=process.env.PORT||"8080",this.usuarioRoute="/api/usuarios",this.proyectosRoute="/api/proyectos",this.donacionesRoute="/api/donaciones",this.contactosRoute="/api/contactos",this.reportesRoute="/api/reportes",this.visitasRoute="/api/visitas",this.objetoVarioRoute="/api/objetosvarios",this.api="/",this.dbConnection(),this.middlewares(),this.routes()}routes(){this.app.use(this.usuarioRoute,d.default),this.app.use(this.proyectosRoute,c.default),this.app.use(this.donacionesRoute,u.default),this.app.use(this.contactosRoute,p.default),this.app.use(this.reportesRoute,f.default),this.app.use(this.visitasRoute,y.default),this.app.use(this.api,l.default),this.app.use(this.objetoVarioRoute,v.default)}middlewares(){this.app.use(s.default.json()),this.app.use((0,a.default)()),this.app.set("trust proxy",!0)}dbConnection(){return i(this,void 0,void 0,(function*(){yield(0,r.dbConnection)()}))}listen(){this.app.listen(this.port,(()=>{console.log("Server on port "+this.port)}))}}},596:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=(0,o(860).Router)();i.get("/",((e,t)=>{t.json({donacionesRoute:{getDonaciones:"/api/visitas",getDonacion:"/api/visitas/:idDonacion",post:"/api/visitas",put:"/api/visitas/:idDonacion",delete:"/api/visitas/:idDonacion"},proyectosRoute:{getDonaciones:"/api/proyectos",getDonacion:"/api/proyectos/:idProyecto",post:"/api/proyectos",put:"/api/proyectos/:idProyecto",delete:"/api/proyectos/:idProyecto"},usuariosRoute:{getDonaciones:"/api/usuarios",getDonacion:"/api/usuarios:idUsuario",post:"/api/usuarios",put:"/api/usuarios/:idUsuario",delete:"/api/usuarios:idUsuario"},contactosRoute:{getDonaciones:"/api/contactos",getDonacion:"/api/contactos/:idUsuario",post:"/api/contactos",put:"/api/contactos/:idUsuario",delete:"/api/contactos/:idUsuario"},reportes:{candidadDonacionesByProyecto:"/cantidad_donaciones/:proyecto_id",metricasByProyecto:"/metricas/:proyecto_id"},visitas:{get:"/",post:"/"}})})),t.default=i},330:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(553),s=o(597),a=o(20),r=o(492),d=(0,i.Router)();d.get("/",s.getContactos),d.get("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),r.validarCampos],s.getContacto),d.post("/",[(0,n.check)("name","El name es requerido").not().isEmpty(),(0,n.check)("email","El email es requerido").not().isEmpty(),(0,n.check)("message","El message es obligatorio").not().isEmpty(),r.validarCampos],s.createContacto),d.put("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existeContactoById),r.validarCampos],s.updateContacto),d.delete("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existeContactoById),r.validarCampos],s.deleteContacto),t.default=d},502:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(553),s=o(723),a=o(20),r=o(492),d=(0,i.Router)();d.get("/",s.getDonaciones),d.get("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),r.validarCampos],s.getDonacion),d.post("/",[(0,n.check)("proyecto","El proyecto no es valido").isMongoId(),(0,n.check)("medio_pago","El medio_pago es requerido").not().isEmpty(),(0,n.check)("monto_donacion","El monto_donacion es requerido").not().isEmpty(),(0,n.check)("tipo","El tipo es obligatorio").not().isEmpty(),r.validarCampos],s.createDonacion),d.put("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existeDonacionById),r.validarCampos],s.updateDonacion),d.delete("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existeDonacionById),r.validarCampos],s.deleteDonacion),t.default=d},88:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(553),s=o(447),a=o(20),r=o(492),d=(0,i.Router)();d.get("/",s.getObjetosVarios),d.get("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),r.validarCampos],s.getObjetosVario),d.get("/tipo/:tipo",[(0,n.check)("tipo","El id no es valido").not().isEmpty(),r.validarCampos],s.getObjetosVarioByTipo),d.post("/",[(0,n.check)("tipo","El tipo es requerido").not().isEmpty(),r.validarCampos],s.createObjetosVario),d.put("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existeObjetoById),r.validarCampos],s.updateObjetosVario),d.delete("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existeObjetoById),r.validarCampos],s.deleteObjetosVario),t.default=d},659:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(660),s=o(553),a=o(492),r=o(20),d=(0,i.Router)();d.get("/",n.getProyectos),d.get("/:id",[(0,s.check)("id","El id no es valido").isMongoId(),a.validarCampos],n.getProyecto),d.post("/",[(0,s.check)("descripcion","La descripcion es requerida").not().isEmpty(),(0,s.check)("title","title es requerida").not().isEmpty(),(0,s.check)("fecha_inicio","La fecha_inicio es requerida").not().isEmpty(),a.validarCampos],n.createProyecto),d.put("/:id",[(0,s.check)("id","El id no es valido").isMongoId(),(0,s.check)("id").custom(r.existeProyectoById),a.validarCampos],n.updateProyecto),d.delete("/:id",[(0,s.check)("id","El id no es valido").isMongoId(),(0,s.check)("id").custom(r.existeProyectoById),a.validarCampos],n.deleteProyecto),t.default=d},533:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(610),s=(0,i.Router)();s.get("/cantidad_donaciones/:proyecto_id",n.getCantidadProyectos),s.get("/metricas/estadisticasGenerales",n.getCountPersonsDonacion),s.get("/metricas/getEstadisticasVisitas",n.getEstadisticasVisitas),s.get("/metricas/:proyecto_id",n.getMetricasProyectos),t.default=s},993:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(553),s=o(12),a=o(20),r=o(492),d=(0,i.Router)();d.get("/",s.getUsuarios),d.get("/admin",s.getUsuariosAdmin),d.get("/:id",s.getUsuario),d.post("/",[(0,n.check)("email","email es obligatorio").not().isEmpty(),(0,n.check)("nombre","nombre es obligatorio").not().isEmpty(),(0,n.check)("tipo","tipo es obligatorio").not().isEmpty(),r.validarCampos],s.createUsuario),d.put("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existUsuarioById),r.validarCampos],s.updateUsuario),d.delete("/:id",[(0,n.check)("id","El id no es valido").isMongoId(),(0,n.check)("id").custom(a.existUsuarioById),r.validarCampos],s.deleteUsuario),t.default=d},103:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(860),n=o(912),s=(0,i.Router)();s.get("/",n.getVisitas),s.post("/",n.createVisita),t.default=s},582:e=>{e.exports=require("cors")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},553:e=>{e.exports=require("express-validator")},245:e=>{e.exports=require("moment")},185:e=>{e.exports=require("mongoose")}},t={};!function o(i){var n=t[i];if(void 0!==n)return n.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,o),s.exports}(783)})();